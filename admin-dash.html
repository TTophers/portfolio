<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Service Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#1e40af',
                        accent: '#60a5fa',
                        dark: '#1e293b',
                        light: '#f8fafc'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-100">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <div class="w-64 bg-dark text-white flex flex-col">
            <div class="p-4 border-b border-gray-700">
                <h1 class="text-xl font-bold">Login Dashboard</h1>
                <p class="text-sm text-gray-400">Admin Panel</p>
            </div>
            
            <nav class="flex-1 py-4">
                <a href="#" class="flex items-center px-4 py-3 bg-primary text-white">
                    <i class="fas fa-home mr-3"></i>
                    <span>Dashboard</span>
                </a>
                <a href="Clients.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700">
                    <i class="fas fa-users mr-3"></i>
                    <span>Clients</span>
                </a>
                <a href="Projects.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700">
                    <i class="fas fa-chart-bar mr-3"></i>
                    <span>Projects</span>
                </a>
                <a href="Messages.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700">
                    <i class="fas fa-cog mr-3"></i>
                    <span>Messages</span>
                </a>
                <a href="Payments.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700">
                    <i class="fas fa-shield-alt mr-3"></i>
                    <span>Payments</span>
                </a>
                <a href="Settings.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700">
                    <i class="fas fa-cog mr-3"></i>
                    <span>Settings</span>
                </a>
                <a href="Security.html" class="flex items-center px-4 py-3 text-gray-300 hover:bg-gray-700">
                    <i class="fas fa-shield-alt mr-3"></i>
                    <span>Security</span>
                </a>
            </nav>
            
            <div class="p-4 border-t border-gray-700">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-accent flex items-center justify-center">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="ml-3">
                        <p class="font-medium">Admin User</p>
                        <p class="text-xs text-gray-400">admin@example.com</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Header -->
            <header class="bg-white shadow-sm">
                <div class="flex items-center justify-between p-4">
                    <div class="flex items-center">
                        <button id="menu-toggle" class="mr-4 text-gray-500 hover:text-gray-700 lg:hidden">
                            <i class="fas fa-bars"></i>
                        </button>
                        <h2 class="text-lg font-semibold text-gray-800">Dashboard Overview</h2>
                    </div>
                    
                    <div class="flex items-center space-x-4">
                        <button class="text-gray-500 hover:text-gray-700 relative">
                            <i class="fas fa-bell"></i>
                            <span class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"></span>
                        </button>
                        <button class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Stats Cards -->
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-blue-100 text-primary">
                                <i class="fas fa-users fa-lg"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-500">Total Users</p>
                                <p class="text-2xl font-bold">1,248</p>
                            </div>
                        </div>
                        <div class="mt-4">
                            <span class="text-green-500 text-sm"><i class="fas fa-arrow-up"></i> 12% from last month</span>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-green-100 text-green-500">
                                <i class="fas fa-sign-in-alt fa-lg"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-500">Active Sessions</p>
                                <p class="text-2xl font-bold">342</p>
                            </div>
                        </div>
                        <div class="mt-4">
                            <span class="text-green-500 text-sm"><i class="fas fa-arrow-up"></i> 5% from last hour</span>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-yellow-100 text-yellow-500">
                                <i class="fas fa-exclamation-triangle fa-lg"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-500">Failed Logins</p>
                                <p class="text-2xl font-bold">24</p>
                            </div>
                        </div>
                        <div class="mt-4">
                            <span class="text-red-500 text-sm"><i class="fas fa-arrow-up"></i> 3% from yesterday</span>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex items-center">
                            <div class="p-3 rounded-full bg-purple-100 text-purple-500">
                                <i class="fas fa-sync-alt fa-lg"></i>
                            </div>
                            <div class="ml-4">
                                <p class="text-sm text-gray-500">Avg. Login Time</p>
                                <p class="text-2xl font-bold">1.2s</p>
                            </div>
                        </div>
                        <div class="mt-4">
                            <span class="text-green-500 text-sm"><i class="fas fa-arrow-down"></i> 0.3s improvement</span>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity & Chart Section -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Recent Activity -->
                    <div class="bg-white rounded-lg shadow">
                        <div class="p-4 border-b">
                            <h3 class="font-semibold text-gray-800">Recent Activity</h3>
                        </div>
                        <div class="p-4">
                            <div class="space-y-4">
                                <div class="flex items-start">
                                    <div class="p-2 rounded-full bg-green-100 text-green-500">
                                        <i class="fas fa-user-plus"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="font-medium">New user registered</p>
                                        <p class="text-sm text-gray-500">john.doe@example.com</p>
                                        <p class="text-xs text-gray-400">2 minutes ago</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-start">
                                    <div class="p-2 rounded-full bg-blue-100 text-blue-500">
                                        <i class="fas fa-sign-in-alt"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="font-medium">User login</p>
                                        <p class="text-sm text-gray-500">jane.smith@example.com</p>
                                        <p class="text-xs text-gray-400">15 minutes ago</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-start">
                                    <div class="p-2 rounded-full bg-yellow-100 text-yellow-500">
                                        <i class="fas fa-exclamation-circle"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="font-medium">Failed login attempt</p>
                                        <p class="text-sm text-gray-500">Invalid credentials</p>
                                        <p class="text-xs text-gray-400">1 hour ago</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-start">
                                    <div class="p-2 rounded-full bg-purple-100 text-purple-500">
                                        <i class="fas fa-key"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="font-medium">Password reset</p>
                                        <p class="text-sm text-gray-500">mike.jones@example.com</p>
                                        <p class="text-xs text-gray-400">3 hours ago</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Login Statistics Chart Placeholder -->
                    <div class="bg-white rounded-lg shadow">
                        <div class="p-4 border-b">
                            <h3 class="font-semibold text-gray-800">Login Statistics</h3>
                        </div>
                        <div class="p-4 h-80 flex items-center justify-center">
                            <div class="text-center">
                                <i class="fas fa-chart-line text-gray-300 text-4xl mb-4"></i>
                                <p class="text-gray-500">Login statistics chart will appear here</p>
                                <p class="text-sm text-gray-400 mt-2">Connect to Firebase to see real data</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="mt-8">
                    <div class="bg-white rounded-lg shadow">
                        <div class="p-4 border-b">
                            <h3 class="font-semibold text-gray-800">Quick Actions</h3>
                        </div>
                        <div class="p-6">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <button class="flex flex-col items-center justify-center p-6 bg-blue-50 rounded-lg hover:bg-blue-100 transition">
                                    <div class="w-12 h-12 rounded-full bg-blue-100 text-primary flex items-center justify-center mb-3">
                                        <i class="fas fa-user-plus fa-lg"></i>
                                    </div>
                                    <span class="font-medium text-gray-700">Add User</span>
                                </button>
                                
                                <button class="flex flex-col items-center justify-center p-6 bg-green-50 rounded-lg hover:bg-green-100 transition">
                                    <div class="w-12 h-12 rounded-full bg-green-100 text-green-500 flex items-center justify-center mb-3">
                                        <i class="fas fa-key fa-lg"></i>
                                    </div>
                                    <span class="font-medium text-gray-700">Reset Password</span>
                                </button>
                                
                                <button class="flex flex-col items-center justify-center p-6 bg-purple-50 rounded-lg hover:bg-purple-100 transition">
                                    <div class="w-12 h-12 rounded-full bg-purple-100 text-purple-500 flex items-center justify-center mb-3">
                                        <i class="fas fa-download fa-lg"></i>
                                    </div>
                                    <span class="font-medium text-gray-700">Export Data</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mobile menu toggle functionality
        document.getElementById('menu-toggle').addEventListener('click', function() {
            const sidebar = document.querySelector('.w-64');
            sidebar.classList.toggle('hidden');
        });

        // Simulate loading data
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Dashboard loaded - ready to connect to Firebase');
        });
    </script>
    <script type="module">
        

const auth2 = getAuth();
const db2 = getFirestore();

auth2.onAuthStateChanged(async (user) => {
  if (!user) {
    console.log("No user logged in");
    return;
  }

  console.log("Logged in UID:", user.uid);

  const snap = await getDoc(doc(db, "users", user.uid));
  console.log("Firestore doc exists:", snap.exists());
  if (snap.exists()) console.log("Firestore data:", snap.data());
});

      // ADMIN GUARD SCRIPT INIT
      console.log("ADMIN GUARD SCRIPT INIT");
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
      import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyCmACuB6COC6welNT7uN5aX4BXYVL-OEF8",
        authDomain: "tophers-design.firebaseapp.com",
        projectId: "tophers-design",
        storageBucket: "tophers-design.firebasestorage.app",
        messagingSenderId: "163525514090",
        appId: "1:163525514090:web:180497723fe8b8f5694b13"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      // Function to check if user is admin
      async function checkAdmin(user) {
        try {
          const userRef = doc(db, "users", user.uid);
          const snap = await getDoc(userRef);
          console.log("Firestore user doc:", snap.exists() ? snap.data() : "NO DOC");
          if (!snap.exists() || snap.data().role !== "admin") {
            console.warn("User is not admin, signing out...");
            await signOut(auth);
            window.location.href = "login.html";
            return;
          }
          console.log("Admin verified:", user.email);
        } catch (err) {
          console.error("Auth guard error", err);
          window.location.href = "login.html";
        }
      }

      // Listen for authentication state changes
      onAuthStateChanged(auth, (user) => {
        if (!user) {
          console.warn("No user logged in, redirecting to login");
          window.location.href = "login.html";
          return;
        }
        checkAdmin(user);
      });
    </script>
</body>
</html>